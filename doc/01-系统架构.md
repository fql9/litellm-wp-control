# 系统架构

> [< 上一篇：快速上手](00-快速上手.md) | [返回目录](README.md) | [下一篇：版本选择与锁定 >](02-版本选择与锁定.md)

## 目标

- WordPress 作为“管理入口”：Key 管理、监控展示、运维入口（iframe `/ui`）
- LiteLLM 作为“LLM 网关”：模型路由、鉴权、配额/预算、用量/成本、审计
- 观测栈统一：Prometheus/Grafana/Alertmanager（可扩展日志）

## 组件与数据流

```
┌─────────────────────────────────────────────────────────────────┐
│                     WordPress（宿主机原生）                        │
│  (Key 管理 | 监控面板 | 权限与审计 | iframe 嵌入 /ui)                │
└────────────────────┬────────────────────────────────────────────┘
                     │ 服务器端调用（PHP → LiteLLM 管理接口）
                     │ + iframe（反代域名 → /ui）
                     ▼
┌─────────────────────────────────────────────────────────────────┐
│                 LiteLLM（Docker，127.0.0.1:24157）                 │
│  - OpenAI 兼容 API (/v1/...)                                       │
│  - Key 管理 (/key/...)                                             │
│  - 统计/指标（/metrics，视版本能力）                                │
│  - 原生 UI (/ui)                                                   │
└────────────────────┬────────────────────────────────────────────┘
                     │ Docker 私网
          ┌──────────┴──────────┐
          ▼                     ▼
    PostgreSQL（Docker）     Redis（Docker，可选）

可选观测栈（Docker）：
Prometheus / Grafana / Alertmanager / node_exporter / cAdvisor / blackbox
```

## 生产关键约束（必须理解）

- LiteLLM 的端口 **不对公网暴露**（只绑定回环），对外只通过宿主机 Nginx/Apache 反代
- WordPress 插件与 LiteLLM 的管理接口交互应尽量走 **服务器端**，不要把管理 token 暴露给浏览器

