# 故障排查

> [< 上一篇：运维](08-运维（备份-升级-回滚）.md) | [返回目录](README.md)

## 1) iframe 无法加载 `/ui`

常见原因：
- 反代层返回 `X-Frame-Options: SAMEORIGIN`
- CSP 未允许 WordPress 域名作为 frame-ancestors

处理：
- 使用 `../nginx/litellm.conf` 的思路：`proxy_hide_header X-Frame-Options;` + `Content-Security-Policy: frame-ancestors ...`

## 2) `401 Unauthorized`

常见原因：
- WordPress 用了错误的 key（把业务 key 当管理 key、或 key 已被 block）
- Authorization header 格式不正确

处理建议：
- 用 `service key` 做管理操作，不要用 master key/业务 key 混用
- 在服务端（PHP）打印受控的错误信息（注意脱敏）

## 3) Prometheus 抓不到指标

常见原因：
- LiteLLM 版本未启用 `/metrics`
- Prometheus target 配置不对

处理建议：
- 先用 blackbox 探测 `/health` 确认服务可用（本项目已内置）
- 再根据你锁定的 LiteLLM 版本确认 metrics 能力与指标名

