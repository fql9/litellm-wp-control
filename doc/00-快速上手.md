# 快速上手（完整链路：WordPress HTTPS + LiteLLM + HTTPS 子域名 + 插件 + 观测）

> [返回目录](README.md) | [下一篇：系统架构 >](01-系统架构.md)

> 文档默认 LiteLLM 版本：**v1.80.11**（更新日期：**2026-01-13**）

本章给你一条“从零到可用”的最短路径：**先部署 LiteLLM（Docker）**，再配置 **Nginx + 通配符证书** 提供 `https://litellm.<domain>`，最后在 WordPress（HTTPS）后台完成插件安装与配置。

> 注意：部署脚本 `scripts/deploy-full.sh` **只负责 LiteLLM（含观测栈）**，不负责 Nginx/证书/WordPress；这些步骤在本章与 `05-WordPress-集成（企业级要点）.md` 中手工完成。

---

## 0. 你需要准备什么（事前检查清单）

以你们当前环境为例：

- WordPress 后台域名：`https://agent.xooer.com`
- 计划的 LiteLLM 子域名：`https://litellm.xooer.com`
- 证书：通配符证书 `*.xooer.com`（✅覆盖 `litellm.xooer.com`）

你需要确认：

- **DNS**：`litellm.xooer.com` 的 A 记录指向本服务器公网 IP
- **端口**：80/443 可达（外部访问 LiteLLM 子域名）
- **权限**：你有 root/sudo（部署 Docker、改 Nginx 配置）

---

## 1. 部署 LiteLLM（含观测栈）

在本仓库目录执行：

```bash
sudo bash scripts/deploy-full.sh \
  --install-deps \
  --litellm-image ghcr.io/berriai/litellm:v1.80.11
```

验证（在服务器执行）：

```bash
curl -fsS http://127.0.0.1:24157/health
curl -fsS http://127.0.0.1:9090/-/healthy
curl -fsS http://127.0.0.1:3000/api/health
```

---

## 2. 生成/获取 service key（给 WordPress 后端调用）

在服务器执行：

```bash
sudo bash scripts/deploy-full.sh --service-key
sudo cat /opt/litellm-server/service-key.txt
```

---

## 3. 配置 Nginx：让 LiteLLM 通过 HTTPS 子域名访问（并允许 WP iframe `/ui`）

### 3.1 安装 Nginx（若未安装）

```bash
sudo apt-get update
sudo apt-get install -y nginx
sudo systemctl enable --now nginx
```

### 3.2 配置站点（使用仓库模板）

模板：`../nginx/litellm.conf`

你需要把其中的占位符替换为：

- `litellm.yourcompany.com` → `litellm.xooer.com`
- `https://your-wordpress-domain.com` → `https://agent.xooer.com`
- `ssl_certificate`/`ssl_certificate_key` → 你们通配符证书真实路径

按 Ubuntu/Nginx 习惯落地：

```bash
sudo cp nginx/litellm.conf /etc/nginx/sites-available/litellm.conf
sudo ln -sf /etc/nginx/sites-available/litellm.conf /etc/nginx/sites-enabled/litellm.conf
sudo nginx -t
sudo systemctl reload nginx
```

### 3.3 （推荐）同机自环解析

```bash
echo '127.0.0.1 litellm.xooer.com' | sudo tee -a /etc/hosts
```

验证（任意机器）：

```bash
curl -I https://litellm.xooer.com/ui/ | egrep -i "content-security-policy|x-frame-options"
```

---

## 4. 安装 WordPress 插件并配置（不落库）

### 4.1 安装插件

把 `wordpress-plugin/litellm-dashboard/` 复制到服务器：

- `wp-content/plugins/litellm-dashboard/`

然后在 WordPress 后台 → **插件** → 启用 **LiteLLM Dashboard**。

### 4.2 配置（推荐：写入 wp-config.php 常量）

在 `wp-config.php`（stop editing 之前）加入：

```php
define('LITELLM_API_BASE', 'https://litellm.xooer.com');
define('LITELLM_SERVICE_KEY', 'sk-xxxxx'); // 取自 /opt/litellm-server/service-key.txt
```

---

## 5. 最终验收（2 分钟内应该全部通过）

- LiteLLM 健康：`curl -fsS http://127.0.0.1:24157/health`
- 反代 UI：浏览器打开 `https://litellm.xooer.com/ui/`
- WordPress 后台 → LiteLLM 页面：iframe 正常加载（无 mixed content / refused to frame）

---

## 下一步（详细文档）

- WordPress 集成全细节：`05-WordPress-集成（企业级要点）.md`
- 安全基线（强制）：`07-安全基线（强制项）.md`
- 故障排查：`09-故障排查.md`

