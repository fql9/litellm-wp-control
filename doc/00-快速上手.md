# 快速上手（部署 LiteLLM：Docker + 观测 + service key）

> [返回目录](README.md) | [下一篇：系统架构 >](01-系统架构.md)

## 你会得到什么

- LiteLLM 作为统一 LLM 网关（API/Key/用量/成本/审计的入口）
- Prometheus/Grafana/Alertmanager 的观测与告警（默认启用）
- 一个可用于“管理/发放业务 key”的 **service key**（可通过脚本指令生成/获取）

## 一条命令完成 LiteLLM 全套部署（推荐）

> 安全基线：LiteLLM 仅绑定 `127.0.0.1:24157`，外网不可直连；版本强制锁定（不允许滚动 tag）。

前置条件：

- 你有 root/sudo 权限
- 服务器可联网安装依赖（若使用 `--install-deps`）

执行（在本仓库目录下运行）：

```bash
sudo bash scripts/deploy-full.sh \
  --install-deps \
  --litellm-image ghcr.io/berriai/litellm:vX.Y.Z
```

> 提示：`vX.Y.Z` 需要替换为你要锁定的真实版本（建议从官方 Releases 选择稳定版），否则脚本会要求你重新输入。

脚本参数说明：执行 `sudo bash scripts/deploy-full.sh --help` 查看全部选项（例如 `--enable-ufw --ssh-port` 等）。

脚本会自动完成：

- 复制并生成 `/opt/litellm-server` 所需文件（compose/config/observability）
- 生成随机 Master Key 与 PostgreSQL 密码（如未提供）
- 强制要求你锁定 `LITELLM_IMAGE`（会提示你输入版本/镜像；参考官方仓库）
- 启动 LiteLLM + PostgreSQL + Redis + 观测栈
- 不会生成 service key（由你按需执行下面指令生成/获取）

安全说明（脚本默认不做的事）：

- **不会默认开启 UFW**（避免误封 SSH）。如需启用：追加 `--enable-ufw --ssh-port 22`（按实际 SSH 端口改）

## 验证清单（部署后 2 分钟内应全部通过）

```bash
curl -fsS http://127.0.0.1:24157/health
curl -fsS http://127.0.0.1:9090/-/healthy
curl -fsS http://127.0.0.1:3000/api/health
```

## 生成/获取 service key（用于管理/发放业务 key）

```bash
sudo bash scripts/deploy-full.sh --service-key
```

## 下一步建议

- 如需 WordPress 集成：阅读 `05-WordPress-集成（企业级要点）.md`
- 阅读 `07-安全基线（强制项）.md` 做 UFW/告警渠道/SSO 等生产加固

