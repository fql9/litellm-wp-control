# 快速上手（全功能完整部署：WordPress 原生 + LiteLLM Docker + HTTPS + 观测 + 插件）

> [返回目录](README.md) | [下一篇：系统架构 >](01-系统架构.md)

## 你会得到什么

- LiteLLM 作为统一 LLM 网关（API/Key/用量/成本/审计的入口）
- WordPress 后台作为控制台入口（通过服务端调用 + iframe 嵌入 `/ui`）
- Prometheus/Grafana/Alertmanager 的观测与告警（默认启用）
- 宿主机 Nginx 反代 + HTTPS（默认启用，可选）

## 一条命令完成“全功能完整部署”（推荐）

> 安全基线：LiteLLM 仅绑定 `127.0.0.1:24157`，外网不可直连；对外统一用宿主机 Nginx/Apache 反代；版本强制锁定（不允许滚动 tag）。

前置条件（必须满足）：

- 服务器已安装并运行 WordPress（原生）
- DNS 已将 `litellm.<你的域名>` 指向本服务器公网 IP（若启用 HTTPS）
- 80/443 对外可达（若启用 HTTPS）
- 你有 root/sudo 权限

执行（在本仓库目录下运行）：

```bash
sudo bash scripts/deploy-full.sh \
  --install-deps \
  --litellm-domain litellm.example.com \
  --wp-domain wp.example.com \
  --email admin@example.com \
  --litellm-image ghcr.io/berriai/litellm:vX.Y.Z \
  --enable-tls \
  --configure-wp-config
```

> 提示：`vX.Y.Z` 需要替换为你要锁定的真实版本（建议从官方 Releases 选择稳定版），否则脚本会要求你重新输入。

脚本参数说明：执行 `sudo bash scripts/deploy-full.sh --help` 查看全部选项（例如 `--enable-ufw --ssh-port`、`--wp-root` 等）。

脚本会自动完成：

- 复制并生成 `/opt/litellm-server` 所需文件（compose/config/observability）
- 生成随机 Master Key 与 PostgreSQL 密码（如未提供）
- 强制要求你锁定 `LITELLM_IMAGE`（会提示你输入版本/镜像；参考官方仓库）
- 配置宿主机 Nginx 反代到 `127.0.0.1:24157`（含 iframe 所需 CSP）
- （可选）使用 certbot 配置 HTTPS
- 启动 LiteLLM + PostgreSQL + Redis + 观测栈
- 生成 WordPress 专用 service key，并（可选）写入 `wp-config.php` 常量
- 部署示例插件到 `wp-content/plugins/`（需要你在 WP 后台启用）

安全说明（脚本默认不做的事）：

- **不会默认开启 UFW**（避免误封 SSH）。如需启用：追加 `--enable-ufw --ssh-port 22`（按实际 SSH 端口改）

## 验证清单（部署后 2 分钟内应全部通过）

```bash
curl -fsS http://127.0.0.1:24157/health
curl -fsS https://litellm.example.com/ui/
curl -fsS http://127.0.0.1:9090/-/healthy
curl -fsS http://127.0.0.1:3000/api/health
```

## 下一步建议

- 在 WordPress 后台启用插件：**LiteLLM Dashboard**
- 阅读 `07-安全基线（强制项）.md` 做 UFW/告警渠道/SSO 等生产加固

